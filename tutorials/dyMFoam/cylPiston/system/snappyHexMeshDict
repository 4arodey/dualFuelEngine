/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \\      /  F ield         | OpenFOAM: Addition to OpenFOAM v6
   \\    /   O peration     | Website:  https://github.com/StasF1/dualFuelEngine
    \\  /    A nd           | Version:  0.3-alpha
     \\/     M anipulation  |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      snappyHexMeshDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

#includeEtc "caseDicts/mesh/generation/snappyHexMeshDict.cfg"

castellatedMesh on;
snap            off;
addLayers       off;

geometry
{
    injection
    {
        type    triSurfaceMesh;
        file    "injection.stl";
        regions
        {
            XMinus
            {
                name    injectionXMinus;
            }
            YMinus
            {
                name    injectionYMinus;
            }
            XPlus
            {
                name    injectionXPlus;
            }
            YPlus
            {
                name    injectionYPlus;
            }

            walls
            {
                name    injectionWalls;
            }
            couple1
            {
                name    couple1;
            }
        }
    }

    inlet
    {
        type    triSurfaceMesh;
        file    "inlet.stl";
        regions
        {
            XMinus
            {
                name    inletXMinus;
            }
            YMinus
            {
                name    inletYMinus;
            }
            XPlus
            {
                name    inletXPlus;
            }
            YPlus
            {
                name    inletYPlus;
            }

            walls
            {
                name    inletWalls;
            }
            couple1
            {
                name    couple1;
            }
        }
    }

    cylinder
    {
        type    triSurfaceMesh;
        file    "cylinder.stl";
        regions
        {
            outlet
            {
                name    outlet;
            }
            walls
            {
                name    cylWalls;
            }
            couple2
            {
                name    couple2;
            }
        }
    }
    piston.stl
    {
        type    triSurfaceMesh;
        name    piston;
    }

    valve.stl
    {
        type    triSurfaceMesh;
        name    valve;
    }
};

castellatedMeshControls
{
    features();

    refinementSurfaces
    {
        injection
        {
            patchInfo { type patch; }
            regions
            {
                injectionWalls
                {
                    level (0 0);
                    patchInfo { type patch; }
                }
            }
        }
        inlet
        {
            patchInfo { type patch; }
            regions
            {
                inletWalls
                {
                    level (0 0);
                    patchInfo { type patch; }
                }
            }
        }

        cylinder
        {
            level (0 0);
            patchInfo { type wall; } // all patches has type 'wall' by default
            regions
            {
                couple2
                {
                    level (0 0);
                    patchInfo { type patch; }
                }
            }
        }
        valve
        {
            level (0 0);
            patchInfo { type wall; }
        }
        piston
        {
            level (0 0);
            patchInfo { type wall; }
        }
    }

    refinementRegions
    {
        ".*"
        {
            mode distance;
            levels ((0 0));
        }
    }

    locationInMesh (0 0 3.5);

    nCellsBetweenLevels 1;
}


snapControls /* off */
{
    // explicitFeatureSnap    true;
    // implicitFeatureSnap    false;
}

addLayersControls /* off */
{
    layers
    {
        // Injection/Inlet
        "(injection|inlet)(X|Y)(Plus|Minus)"
        {
            nSurfaceLayers 0;
        }

        // Other surfaces
        outlet
        {
            nSurfaceLayers 0;
        }
        "valve|piston|walls(Cylinder|Injection|Inlet)"
        {
            nSurfaceLayers 0;
        }

        // ACMI surfaces
        "couple(1|2)"
        {
            nSurfaceLayers 0;
        }
    }

    relativeSizes       true; // false, usually with firstLayerThickness
    expansionRatio      1.2;
    finalLayerThickness 0.5;
    minThickness        1e-3;
    //  firstLayerThickness 0.01;

// maxThicknessToMedialRatio 0.6;
}

writeFlags
(
    // scalarLevels
    layerSets
    layerFields
);

mergeTolerance 1e-6;

// ************************************************************************* //
